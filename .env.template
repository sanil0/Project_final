# DDoS Protection Service Configuration
# ================================

# Core Application Settings
# ------------------------
UPSTREAM_BASE_URL=http://localhost:8000  # URL of the upstream service to protect
ADMIN_API_KEY=change_me_in_production   # API key for admin endpoints

# Target Configuration
# -------------------
TARGET_URL=http://localhost:8000         # URL of the protected web application
SENSITIVITY_LEVEL=medium                 # DDoS detection sensitivity (low/medium/high)

# Rate Limiting Settings
# --------------------
BASE_RATE_LIMIT=120                     # Base number of requests allowed per window
RATE_WINDOW_SECONDS=60                  # Time window for rate limiting in seconds
BURST_MULTIPLIER=1.5                    # Multiplier for burst allowance
DYNAMIC_RATE_ADJUSTMENT=true            # Enable ML-based rate adjustment

# Blocking Configuration
# --------------------
BLOCK_DURATION_MINUTES=30               # Initial blocking duration for malicious IPs
BLOCK_THRESHOLD_VIOLATIONS=3            # Violations before blocking
PROGRESSIVE_BLOCKING=true               # Increase block duration for repeat offenders
MAX_BLOCK_DURATION_HOURS=24            # Maximum block duration

# ML Model Settings
# ---------------
MODEL_PATH=models                       # Path to ML model files
MODEL_UPDATE_INTERVAL_HOURS=24         # How often to check for model updates
ENABLE_MODEL_CACHE=true                # Enable prediction caching
MODEL_CACHE_TTL_SECONDS=300           # Cache TTL in seconds
MODEL_CACHE_MAX_SIZE=10000            # Maximum cached predictions
BATCH_PREDICTION_SIZE=100             # Batch size for predictions

# Feature Extraction
# ----------------
FEATURE_WINDOW_SECONDS=300            # Time window for feature extraction
MIN_SAMPLES_REQUIRED=10               # Minimum samples needed for prediction

# IP Management
# ------------
BLOCKLIST_IPS=                        # Comma-separated list of IPs to block
WHITELIST_IPS=                        # Comma-separated list of IPs to always allow
TRUSTED_PROXIES=                      # Comma-separated list of trusted proxy CIDRs
COUNTRY_BLOCKLIST=                    # Comma-separated list of country codes to block
ASN_BLOCKLIST=                        # Comma-separated list of ASNs to block
IP_REPUTATION_THRESHOLD=0.7           # Minimum IP reputation score (0.0-1.0)

# Request Processing
# ----------------
HONOR_X_FORWARDED_FOR=false          # Whether to trust X-Forwarded-For header
MAX_REQUEST_SIZE_KB=1024             # Maximum request size in KB
ENABLE_REQUEST_VALIDATION=true       # Enable request payload validation